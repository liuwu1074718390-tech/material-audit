# 修复数据库名称配置

## 问题说明
你在腾讯云创建了名为 `myapp` 的数据库，但 `.env` 文件中的 `DB_NAME` 可能配置为其他名称（如 `audit_db`），导致连接不到正确的数据库。

## 解决步骤

### 步骤 1: 打开 `.env` 文件

在项目根目录 `/Users/liuwu/Desktop/材价审计` 下找到 `.env` 文件并打开。

### 步骤 2: 修改数据库名称

找到 `DB_NAME` 这一行，修改为：

```env
DB_NAME=myapp
```

**完整配置示例**：
```env
# Dify API配置
DIFY_API_KEY=app-CaJJxI5P0DrvwNXAhABB37M6
DIFY_API_URL=http://192.168.1.42/v1/workflows/run
DIFY_WORKFLOW_ID=6495412f-cb02-4702-a1e4-5471a37919c7

# 腾讯云数据库配置
DB_HOST=你的数据库地址
DB_PORT=3306
DB_USER=你的用户名
DB_PASSWORD=你的密码
DB_NAME=myapp  # 修改为你的数据库名
```

### 步骤 3: 验证表是否存在

在腾讯云控制台的 SQL 窗口中执行：

```sql
USE myapp;
SHOW TABLES;
```

应该看到三个表：
- `audit_tasks`
- `audit_materials`
- `audit_results`

### 步骤 4: 重启服务器

修改 `.env` 文件后，必须重启服务器：

1. **停止当前服务器**：
   - 在运行 `npm run dev` 的终端窗口
   - 按 `Ctrl + C` 停止

2. **重新启动**：
   ```bash
   npm run dev
   ```

### 步骤 5: 验证配置

1. **访问健康检查页面**：
   - `http://localhost:3000/health`
   - 应该看到所有检查都正常

2. **测试获取任务列表**：
   - 刷新主页面
   - 应该能正常加载任务列表

## 常见问题

### Q: 如何确认数据库名是否正确？

A: 在腾讯云控制台的数据库管理页面，查看你创建的数据库名称。

### Q: 修改后还是报错？

A: 检查：
1. `.env` 文件是否保存
2. 服务器是否已重启
3. 数据库名是否完全匹配（大小写敏感）

### Q: 如何确认表已创建？

A: 在 SQL 窗口中执行：
```sql
USE myapp;
SHOW TABLES;
SELECT COUNT(*) FROM audit_tasks;
SELECT COUNT(*) FROM audit_materials;
SELECT COUNT(*) FROM audit_results;
```

