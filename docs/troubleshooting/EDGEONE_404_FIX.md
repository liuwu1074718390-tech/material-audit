# ğŸ”§ EdgeOne 404 é”™è¯¯ä¿®å¤æŒ‡å—

## é—®é¢˜è¯Šæ–­

è®¿é—® EdgeOne éƒ¨ç½²çš„é“¾æ¥æ—¶æ˜¾ç¤ºï¼š
```
404: NOT_FOUND
The page does not exist
```

## ğŸ” å¯èƒ½çš„åŸå› 

### åŸå›  1: SPA è·¯ç”±æœªé…ç½®

Nuxt 3 åº”ç”¨ä½¿ç”¨å®¢æˆ·ç«¯è·¯ç”±ï¼ˆSPA æ¨¡å¼ï¼‰ï¼Œæ‰€æœ‰è·¯ç”±éƒ½åº”è¯¥æŒ‡å‘ `index.html`ï¼Œç”±å‰ç«¯è·¯ç”±å¤„ç†ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… å·²åˆ›å»º `public/_redirects` æ–‡ä»¶
- âœ… é…ç½®äº† SPA fallback è§„åˆ™

### åŸå›  2: å‘å¸ƒç›®å½•ä¸æ­£ç¡®

EdgeOne å¯èƒ½é…ç½®äº†é”™è¯¯çš„å‘å¸ƒç›®å½•ã€‚

**æ­£ç¡®çš„å‘å¸ƒç›®å½•**ï¼š`.output/public`

### åŸå›  3: éœ€è¦é…ç½® Nginx æˆ– Web æœåŠ¡å™¨

å¦‚æœéƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šï¼Œéœ€è¦é€šè¿‡ Nginx æˆ–å…¶ä»– Web æœåŠ¡å™¨ï¼Œéœ€è¦é…ç½®é‡å®šå‘è§„åˆ™ã€‚

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨é™æ€éƒ¨ç½² + SPA Fallbackï¼ˆæ¨èï¼‰

å·²åˆ›å»º `public/_redirects` æ–‡ä»¶ï¼ŒåŒ…å«æ­£ç¡®çš„é‡å®šå‘è§„åˆ™ã€‚

**ç¡®ä¿**ï¼š
1. `public/_redirects` æ–‡ä»¶å­˜åœ¨
2. æ„å»ºåæ–‡ä»¶ä¼šå¤åˆ¶åˆ° `.output/public/_redirects`
3. EdgeOne é…ç½®çš„å‘å¸ƒç›®å½•æ˜¯ `.output/public`

### æ–¹æ¡ˆäºŒï¼šåœ¨ EdgeOne æ§åˆ¶å°é…ç½®é‡å®šå‘è§„åˆ™

å¦‚æœ EdgeOne æ”¯æŒè‡ªå®šä¹‰é‡å®šå‘è§„åˆ™ï¼Œé…ç½®ä»¥ä¸‹è§„åˆ™ï¼š

```
# API è·¯ç”±ä¿æŒåŸæ ·
/api/* â†’ /api/* (200)

# é™æ€èµ„æºä¿æŒåŸæ ·
/_nuxt/* â†’ /_nuxt/* (200)
/assets/* â†’ /assets/* (200)
/favicon.ico â†’ /favicon.ico (200)

# æ‰€æœ‰å…¶ä»–è·¯ç”±é‡å®šå‘åˆ° index.html
/* â†’ /index.html (200)
```

### æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨ Nginxï¼ˆå¦‚æœéƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šï¼‰

å¦‚æœåº”ç”¨éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡ Nginx è®¿é—®ï¼Œæ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;
    root /path/to/your/app/.output/public;
    index index.html;

    # API è·¯ç”±ä»£ç†åˆ°åç«¯ï¼ˆå¦‚æœéœ€è¦ï¼‰
    location /api/ {
        try_files $uri $uri/ =404;
    }

    # é™æ€èµ„æº
    location /_nuxt/ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # SPA fallback - æ‰€æœ‰è·¯ç”±æŒ‡å‘ index.html
    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

## ğŸ“‹ æ£€æŸ¥æ¸…å•

### EdgeOne é…ç½®æ£€æŸ¥

- [ ] **å‘å¸ƒç›®å½•**ï¼šè®¾ç½®ä¸º `.output/public`
- [ ] **æ„å»ºå‘½ä»¤**ï¼š`npm run build`
- [ ] **é‡å®šå‘è§„åˆ™**ï¼šå·²é…ç½®æˆ–ä½¿ç”¨ `_redirects` æ–‡ä»¶
- [ ] **é™æ€æ–‡ä»¶æœåŠ¡**ï¼šå·²å¯ç”¨

### é¡¹ç›®æ–‡ä»¶æ£€æŸ¥

- [ ] `public/_redirects` æ–‡ä»¶å­˜åœ¨ âœ…
- [ ] `nuxt.config.ts` é…ç½®æ­£ç¡®
- [ ] æ„å»ºæˆåŠŸï¼Œ`.output/public` ç›®å½•å­˜åœ¨
- [ ] `index.html` æ–‡ä»¶åœ¨ `.output/public` ç›®å½•ä¸­

## ğŸ”§ å¿«é€Ÿä¿®å¤æ­¥éª¤

### æ­¥éª¤ 1: ç¡®è®¤æ–‡ä»¶å­˜åœ¨

```bash
# æ£€æŸ¥ _redirects æ–‡ä»¶
ls -la public/_redirects

# æ£€æŸ¥æ„å»ºè¾“å‡º
ls -la .output/public/
```

### æ­¥éª¤ 2: é‡æ–°æ„å»ºå’Œéƒ¨ç½²

```bash
# 1. æ¸…ç†æ—§çš„æ„å»º
rm -rf .output

# 2. é‡æ–°æ„å»º
npm run build

# 3. æ£€æŸ¥æ„å»ºè¾“å‡º
ls -la .output/public/

# 4. ç¡®è®¤ _redirects æ–‡ä»¶å·²å¤åˆ¶
cat .output/public/_redirects
```

### æ­¥éª¤ 3: åœ¨ EdgeOne é…ç½®

1. **æ£€æŸ¥å‘å¸ƒç›®å½•**ï¼š
   - ç¡®ä¿è®¾ç½®ä¸º `.output/public`
   - æˆ– `dist`ï¼ˆå¦‚æœ EdgeOne ä½¿ç”¨ä¸åŒçš„æ„å»ºè¾“å‡ºï¼‰

2. **é…ç½®é‡å®šå‘è§„åˆ™**ï¼ˆå¦‚æœ EdgeOne æ”¯æŒï¼‰ï¼š
   - æ·»åŠ  SPA fallback è§„åˆ™
   - æˆ–ç¡®ä¿ `_redirects` æ–‡ä»¶è¢«è¯†åˆ«

3. **é‡æ–°éƒ¨ç½²**

## ğŸ§ª éªŒè¯ä¿®å¤

ä¿®å¤åè®¿é—®ï¼š
- âœ… ä¸»é¡µåº”è¯¥æ­£å¸¸æ˜¾ç¤º
- âœ… è·¯ç”±å¯¼èˆªåº”è¯¥æ­£å¸¸å·¥ä½œï¼ˆå¦‚ `/health`ï¼‰
- âœ… API è·¯ç”±åº”è¯¥æ­£å¸¸å·¥ä½œï¼ˆå¦‚ `/api/health/db`ï¼‰

## ğŸ’¡ å…¶ä»–å¯èƒ½çš„é—®é¢˜

### é—®é¢˜ 1: æ„å»ºæœªæ‰§è¡Œ

å¦‚æœç›´æ¥ä¸Šä¼ æºä»£ç ï¼Œéœ€è¦å…ˆæ„å»ºï¼š

```bash
npm install
npm run build
```

ç„¶åä¸Šä¼  `.output/public` ç›®å½•çš„å†…å®¹ã€‚

### é—®é¢˜ 2: é™æ€æ–‡ä»¶æœªæ­£ç¡®æœåŠ¡

ç¡®ä¿ EdgeOne é…ç½®äº†æ­£ç¡®çš„ MIME ç±»å‹ï¼š
- `.html` â†’ `text/html`
- `.js` â†’ `application/javascript`
- `.css` â†’ `text/css`
- `.json` â†’ `application/json`

### é—®é¢˜ 3: è·¯å¾„å¤§å°å†™æ•æ„Ÿ

æŸäº›æœåŠ¡å™¨åŒºåˆ†å¤§å°å†™ï¼Œç¡®ä¿è·¯å¾„æ­£ç¡®ï¼š
- `/index.html` âœ…
- `/Index.html` âŒ

## ğŸ†˜ ä»ç„¶æœ‰é—®é¢˜ï¼Ÿ

å¦‚æœæŒ‰ç…§ä¸Šè¿°æ­¥éª¤ä»ç„¶å‡ºç° 404ï¼š

1. **æŸ¥çœ‹ EdgeOne æ—¥å¿—**ï¼š
   - æ£€æŸ¥è¯·æ±‚è·¯å¾„
   - æŸ¥çœ‹é”™è¯¯è¯¦æƒ…

2. **æ£€æŸ¥æ„å»ºè¾“å‡º**ï¼š
   ```bash
   ls -la .output/public/
   cat .output/public/index.html
   ```

3. **æµ‹è¯•æœ¬åœ°æ„å»º**ï¼š
   ```bash
   npm run build
   npm run preview
   # è®¿é—® http://localhost:3000
   ```

4. **è”ç³» EdgeOne æŠ€æœ¯æ”¯æŒ**ï¼š
   - æä¾›é”™è¯¯æ—¥å¿—
   - è¯´æ˜æ˜¯ Nuxt 3 SPA åº”ç”¨
   - è¯¢é—® SPA fallback é…ç½®æ–¹æ³•




