# 服务器启动问题排查

## 问题：Failed to fetch 错误

这个错误通常表示：
1. 服务器没有运行
2. 服务器运行在不同的端口
3. 网络连接问题

## 解决步骤

### 步骤 1: 确认服务器是否运行

在终端运行：
```bash
cd /Users/liuwu/Desktop/材价审计
npm run dev
```

应该看到类似输出：
```
✔ Nuxt is ready
  Local:   http://localhost:3000
  Network: use --host to expose
```

### 步骤 2: 检查端口占用

如果 3000 端口被占用，服务器会自动使用 3001 端口。

检查方法：
```bash
lsof -i :3000
lsof -i :3001
```

### 步骤 3: 访问正确的地址

- 如果服务器在 3000 端口：`http://localhost:3000`
- 如果服务器在 3001 端口：`http://localhost:3001`

### 步骤 4: 检查浏览器控制台

1. 打开浏览器开发者工具（F12）
2. 查看 Console 标签
3. 查看 Network 标签，检查 API 请求是否成功

### 步骤 5: 常见问题

#### 问题 1: 服务器启动失败

**可能原因**：
- 端口被占用
- 依赖未安装
- 配置文件错误

**解决方案**：
```bash
# 清理并重新安装依赖
rm -rf node_modules package-lock.json
npm install

# 重新启动
npm run dev
```

#### 问题 2: 数据库连接错误导致服务器启动失败

**解决方案**：
1. 检查 `.env` 文件配置
2. 访问健康检查页面：`http://localhost:3000/health`
3. 根据错误提示修复配置

#### 问题 3: API 路由 404

**检查**：
- 确认 `server/api/dify/tasks.get.ts` 文件存在
- 确认服务器已完全启动

## 快速测试

1. **启动服务器**：
   ```bash
   cd /Users/liuwu/Desktop/材价审计
   npm run dev
   ```

2. **等待启动完成**（看到 "Nuxt is ready"）

3. **访问系统**：
   - 打开浏览器访问显示的地址（通常是 `http://localhost:3000`）

4. **检查 API**：
   - 访问：`http://localhost:3000/api/health/db`
   - 应该返回 JSON 数据

5. **如果还是失败**：
   - 查看终端中的错误信息
   - 查看浏览器控制台的错误信息
   - 告诉我具体的错误内容

